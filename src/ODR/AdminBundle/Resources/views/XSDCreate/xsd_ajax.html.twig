{% spaceless %}

{% set using_metadata = true %}

<xsd:schema xmlns:xsd="http://www.w3.org/2001/XMLSchema">

    <xsd:annotation>
        <xsd:documentation xml:lang="en">
        </xsd:documentation>
    </xsd:annotation>

{#
    <!-- simple attribute definition -->
    <xsd:complexType name="inline_attribute">
        <xsd:simpleContent>
            <xsd:extension base="xsd:string">
                <xsd:attribute name="attr" type="xsd:string">
                </xsd:attribute>
            </xsd:extension>
        </xsd:simpleContent>
    </xsd:complexType>
#}

    <!-- more normal datetime string definition... -->
    <xsd:simpleType name="normal_datetime">
        <xsd:restriction base="xsd:string">
            <xsd:pattern value="([0-9]{4})-(0[0-9]|1[0-2])-(0[0-9]|1[0-9]|2[0-9]|3[0-1]) (0[0-9]|1[0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9])" />
        </xsd:restriction>
    </xsd:simpleType>

    <!-- definition of a file -->
    <xsd:complexType name="file_type">
        <xsd:all>
            <xsd:element name="original_name" type="xsd:string" />
            <xsd:element name="source">
                <xsd:complexType>
                    <xsd:simpleContent>
                        <xsd:extension base="xsd:string">
                            <xsd:attribute name="type">
                                <xsd:simpleType>
                                    <xsd:restriction base="xsd:string">
                                        <xsd:pattern value="href|local_filename" />
                                    </xsd:restriction>
                                </xsd:simpleType>
                            </xsd:attribute>
                        </xsd:extension>
                    </xsd:simpleContent>
                </xsd:complexType>
            </xsd:element>
            <xsd:element name="checksum" type="xsd:string" />
            <xsd:element name="_file_metadata" minOccurs="0" maxOccurs="1">
                <xsd:complexType>
                    <xsd:all>
                        <xsd:element name="_create_date" type="normal_datetime" minOccurs="0" maxOccurs="1" />
                        <xsd:element name="_create_auth" type="xsd:string" minOccurs="0" maxOccurs="1" />
                        <xsd:element name="_public_date" type="normal_datetime" minOccurs="0" maxOccurs="1" />
                        <xsd:element name="_external_id" type="xsd:string" minOccurs="0" maxOccurs="1" />
                    </xsd:all>
                </xsd:complexType>
            </xsd:element>
        </xsd:all>
    </xsd:complexType>

    <!-- definition of a file control -->
    <xsd:complexType name="datafield_file_type">
        <xsd:sequence>
            <xsd:element name="file" type="file_type" minOccurs="0" maxOccurs="unbounded" />
        </xsd:sequence>
    </xsd:complexType>

    <!-- definition of a file control permitting just one file upload -->
    <xsd:complexType name="datafield_file_type_single">
        <xsd:sequence>
            <xsd:element name="file" type="file_type" minOccurs="0" maxOccurs="1" />
        </xsd:sequence>
    </xsd:complexType>

    <!-- definition of an image -->
    <xsd:complexType name="image_type">
        <xsd:all>
            <xsd:element name="original_name" type="xsd:string" />
            <xsd:element name="source">
                <xsd:complexType>
                    <xsd:simpleContent>
                        <xsd:extension base="xsd:string">
                            <xsd:attribute name="type">
                                <xsd:simpleType>
                                    <xsd:restriction base="xsd:string">
                                        <xsd:pattern value="href|local_filename" />
                                    </xsd:restriction>
                                </xsd:simpleType>
                            </xsd:attribute>
                        </xsd:extension>
                    </xsd:simpleContent>
                </xsd:complexType>
            </xsd:element>
            <xsd:element name="checksum" type="xsd:string" />
            <xsd:element name="caption" type="xsd:string" />
            <xsd:element name="_image_metadata" minOccurs="0" maxOccurs="1">
                <xsd:complexType>
                    <xsd:all>
                        <xsd:element name="_display_order" type="xsd:string" minOccurs="0" maxOccurs="1" />
                        <xsd:element name="_create_date" type="normal_datetime" minOccurs="0" maxOccurs="1" />
                        <xsd:element name="_create_auth" type="xsd:string" minOccurs="0" maxOccurs="1" />
                        <xsd:element name="_public_date" type="normal_datetime" minOccurs="0" maxOccurs="1" />
                        <xsd:element name="_external_id" type="xsd:string" minOccurs="0" maxOccurs="1" />
                    </xsd:all>
                </xsd:complexType>
            </xsd:element>
        </xsd:all>
    </xsd:complexType>

    <!-- definition of an image control -->
    <xsd:complexType name="datafield_image_type">
        <xsd:sequence>
            <xsd:element name="image" type="image_type" minOccurs="0" maxOccurs="unbounded" />
        </xsd:sequence>
    </xsd:complexType>

    <!-- definition of an image control permitting just one image upload -->
    <xsd:complexType name="datafield_image_type_single">
        <xsd:sequence>
            <xsd:element name="image" type="image_type" minOccurs="0" maxOccurs="1" />
        </xsd:sequence>
    </xsd:complexType>

    <!-- metadata definition for datarecord -->
    <xsd:complexType name="datarecord_metadata_type">
        <xsd:all>
            <xsd:element name="_external_id" type="xsd:string" minOccurs="0" maxOccurs="1" />
            <xsd:element name="_create_date" type="normal_datetime" minOccurs="0" maxOccurs="1" />
            <xsd:element name="_create_auth" type="xsd:string" minOccurs="0" maxOccurs="1" />
            <xsd:element name="_public_date" type="normal_datetime" minOccurs="0" maxOccurs="1" />
        </xsd:all>
    </xsd:complexType>

    <!-- actual definition of the datarecord -->
    <xsd:complexType name="datarecord_type">
        <xsd:all>
            {% import "ODRAdminBundle:XSDCreate:xsd_area_childtype.html.twig" as mychildform %}
            {{ mychildform.input(datatype_tree) }}

            <xsd:element name="_datarecord_metadata" type="datarecord_metadata_type" minOccurs="0" maxOccurs="1" />

        </xsd:all>
        <xsd:attribute name="datatype_name" type="xsd:string" use="required" />
    </xsd:complexType>

    <!-- allow for multiple datarecords -->
    <xsd:element name="datarecords">
        <xsd:complexType>
            <xsd:sequence>
                <xsd:element name="datarecord" type="datarecord_type" minOccurs="1" maxOccurs="unbounded" />
            </xsd:sequence>
        </xsd:complexType>
    </xsd:element>

</xsd:schema>

{% endspaceless %}
