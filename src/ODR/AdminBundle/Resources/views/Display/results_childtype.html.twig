{#
{% macro input(parent_data_record_id, data_record_id, data_record_array, linked_data_array, theme_data_by_type) %}
#}
{% spaceless %}
    {# {{ parent_data_record_id }} {{ data_record_id }} #}
    {% if data_record_array[parent_data_record_id] is defined and data_record_array[parent_data_record_id][data_record_id] is defined %}

        {% set current_data_record = data_record_array[parent_data_record_id][data_record_id] %}
        {% set datatype = data_record_array[parent_data_record_id][data_record_id].dataType %}
        {% set render_plugin = datatype.renderPlugin %}

        {#
           Use childtype_render to render the actual child type.
           Default operation using data record data
        #}
        {#
        {% import "ODRAdminBundle:Display:results_childtype_render.html.twig" as childrender %}
        {{ childrender.input(parent_data_record_id, current_data_record.id, data_record_array, linked_data_array, theme_data_by_type) }}
        #}
        {%  include "ODRAdminBundle:Display:results_childtype_render.html.twig" with {'parent_data_record_id': parent_data_record_id, 'data_record_id': current_data_record.id, 'data_record_array': data_record_array, 'linked_data_array': linked_data_array, 'theme_data_by_type': theme_data_by_type} %}
    {% else %}
        {# If current data record is null, use linked data array as data_record_array #}

        {% set current_data_record = linked_data_array[parent_data_record_id][data_record_id] %}
        {% set datatype = linked_data_array[parent_data_record_id][data_record_id].dataType %}
        {% set render_plugin = datatype.renderPlugin %}

        {#
            Use childtype_render to render the actual child type.
            Linked Data
        #}
        {#
        {% import "ODRAdminBundle:Display:results_childtype_render.html.twig" as childrender %}
        {{ childrender.input(parent_data_record_id, current_data_record.id, linked_data_array, linked_data_array, theme_data_by_type) }}
        #}
        {%  include "ODRAdminBundle:Display:results_childtype_render.html.twig" with {'parent_data_record_id': parent_data_record_id, 'data_record_id': current_data_record.id, 'data_record_array': linked_data_array, 'linked_data_array': linked_data_array, 'theme_data_by_type': theme_data_by_type} %}
    {%  endif %}

{% endspaceless %}
{#
{% endmacro %}
#}
