{% spaceless %}

<div class="ODRFormWrap ODRRecord pure-u-1"> 

    {% if is_top_level == 1 %}
        {% include 'ODRAdminBundle:Edit:edit_childtype.html.twig' with {
            'datatype_array': datatype_array,
            'datarecord_array': datarecord_array,
            'theme_array': theme_array,

            'target_datatype_id': initial_datatype_id,
            'parent_datarecord_id': initial_datarecord_id,
            'target_theme_id': initial_theme_id,

            'datatype_permissions': datatype_permissions,
            'datafield_permissions': datafield_permissions,

            'is_top_level': is_top_level,
            'is_link': 0,
            'display_type': 0,

            'token_list': token_list,
        } %}
    {% else %}
        {# render a child datarecord as if it's a top-level datarecord #}
        {% set datarecord = datarecord_array[initial_datarecord_id] %}

        {% include 'ODRAdminBundle:Edit:edit_childtype.html.twig' with {
            'datatype_array': datatype_array,
            'datarecord_array': datarecord_array,
            'theme_array': theme_array,

            'target_datatype_id': initial_datatype_id,
            'parent_datarecord_id': datarecord.parent.id,
            'target_theme_id': initial_theme_id,

            'datatype_permissions': datatype_permissions,
            'datafield_permissions': datafield_permissions,

            'is_top_level': is_top_level,
            'is_link': 0,
            'display_type': 0,

            'token_list': token_list,
        } %}
    {% endif %}

</div><!-- End of .ODRFormWrap -->

{% endspaceless %}
