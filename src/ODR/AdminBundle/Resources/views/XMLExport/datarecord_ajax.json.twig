{# Twig doesn't have a decent spaceless tag for json #}

{% set is_top_level = 1 %}
{% set is_link = 0 %}

{# using macro on purpose #}
{% import "ODRAdminBundle:XMLExport:datarecord_childtype.json.twig" as mychildform %}

[
{% for initial_datarecord_id in sorted_datarecord_ids %}
    {% set data = lookup_array[initial_datarecord_id] %}

    {% set initial_datatype_id = data['datatype'] %}
    {% set initial_theme_id = data['theme'] %}

    {% set datarecord_array_subset = datarecord_array[initial_datarecord_id] %}
    {% set datatype_array_subset = datatype_array[initial_datatype_id] %}
    {% set theme_array_subset = theme_array[initial_theme_id] %}

    {{ mychildform.input(datatype_array_subset, datarecord_array_subset, theme_array_subset, initial_datatype_id, initial_datarecord_id, initial_theme_id, is_top_level, is_link, using_metadata, baseurl, version) }},
{% endfor %}
]
